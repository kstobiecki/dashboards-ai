'use client';

import { ExploreCard } from '../context/ExploreContext';
import { nanoid } from 'nanoid';

export const createWeatherCard = (): ExploreCard => ({
  id: `weather-${nanoid(10)}`,
  conversationHistory: {
    prompts: 'Create a dashboard that displays the weather for Los Angeles. Use any free open weather API to get the data. Refresh the data every 10 minutes.',
    html: Buffer.from(encodedHtml, 'base64').toString('utf8'),
  },
  intervalSettings: {
    isEnabled: false,
    interval: 5,
    prompt: '',
  },
});

const encodedHtml = "PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KPGhlYWQ+CiAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+CiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCI+CiAgICA8dGl0bGU+TG9zIEFuZ2VsZXMgV2VhdGhlciBEYXNoYm9hcmQ8L3RpdGxlPgogICAgPGxpbmsgaHJlZj0iaHR0cHM6Ly93d3cudW5wa2cuY29tL3RhaWx3aW5kY3NzQDIuMi4xOS9kaXN0L3RhaWx3aW5kLm1pbi5jc3MiIHJlbD0ic3R5bGVzaGVldCI+CiAgICA8c2NyaXB0IHNyYz0iaHR0cHM6Ly93d3cudW5wa2cuY29tL2xpZ2h0d2VpZ2h0LWNoYXJ0c0A0LjAuMC9kaXN0L2xpZ2h0d2VpZ2h0LWNoYXJ0cy5zdGFuZGFsb25lLnByb2R1Y3Rpb24uanMiPjwvc2NyaXB0PgogICAgPHN0eWxlPgogICAgICAgIGJvZHkgewogICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMTgxODFiOwogICAgICAgICAgICBjb2xvcjogI2ZhZmFmYTsKICAgICAgICAgICAgZm9udC1mYW1pbHk6IC1hcHBsZS1zeXN0ZW0sIEJsaW5rTWFjU3lzdGVtRm9udCwgIlNlZ29lIFVJIiwgUm9ib3RvLCBIZWx2ZXRpY2EsIEFyaWFsLCBzYW5zLXNlcmlmOwogICAgICAgIH0KICAgICAgICAud2VhdGhlci1jYXJkIHsKICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgzMCwgMzAsIDQ2LCAwLjYpOwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiAxNnB4OwogICAgICAgICAgICBib3gtc2hhZG93OiAwIDEwcHggMzBweCByZ2JhKDAsIDAsIDAsIDAuMyk7CiAgICAgICAgICAgIGJhY2tkcm9wLWZpbHRlcjogYmx1cigxMnB4KTsKICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjA4KTsKICAgICAgICAgICAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuMnMsIGJveC1zaGFkb3cgMC4yczsKICAgICAgICB9CiAgICAgICAgLndlYXRoZXItY2FyZDpob3ZlciB7CiAgICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtNXB4KTsKICAgICAgICAgICAgYm94LXNoYWRvdzogMCAxNXB4IDM1cHggcmdiYSgwLCAwLCAwLCAwLjQpOwogICAgICAgIH0KICAgICAgICAubG9hZGluZyB7CiAgICAgICAgICAgIGJvcmRlcjogM3B4IHNvbGlkIHJnYmEoMTgwLCAxODAsIDE4MCwgMC4xKTsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNTAlOwogICAgICAgICAgICBib3JkZXItdG9wOiAzcHggc29saWQgI2EwYTBhMDsKICAgICAgICAgICAgd2lkdGg6IDQwcHg7CiAgICAgICAgICAgIGhlaWdodDogNDBweDsKICAgICAgICAgICAgYW5pbWF0aW9uOiBzcGluIDFzIGxpbmVhciBpbmZpbml0ZTsKICAgICAgICAgICAgbWFyZ2luOiAwIGF1dG87CiAgICAgICAgfQogICAgICAgIEBrZXlmcmFtZXMgc3BpbiB7CiAgICAgICAgICAgIDAlIHsgdHJhbnNmb3JtOiByb3RhdGUoMGRlZyk7IH0KICAgICAgICAgICAgMTAwJSB7IHRyYW5zZm9ybTogcm90YXRlKDM2MGRlZyk7IH0KICAgICAgICB9CiAgICAgICAgLmdyYWRpZW50LXRleHQgewogICAgICAgICAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoOTBkZWcsICNkNGQ0ZDgsICNmNGY0ZjUpOwogICAgICAgICAgICAtd2Via2l0LWJhY2tncm91bmQtY2xpcDogdGV4dDsKICAgICAgICAgICAgYmFja2dyb3VuZC1jbGlwOiB0ZXh0OwogICAgICAgICAgICAtd2Via2l0LXRleHQtZmlsbC1jb2xvcjogdHJhbnNwYXJlbnQ7CiAgICAgICAgfQogICAgICAgIC5nbGFzcy1oZWFkZXIgewogICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDE3LCAxNywgMjcsIDAuOCk7CiAgICAgICAgICAgIGJhY2tkcm9wLWZpbHRlcjogYmx1cigxMHB4KTsKICAgICAgICB9CiAgICA8L3N0eWxlPgo8L2hlYWQ+Cjxib2R5Pgo8ZGl2IGNsYXNzPSJtaW4taC1zY3JlZW4gZmxleCBmbGV4LWNvbCB3LWZ1bGwgaC1mdWxsIj4KICAgIDwhLS0gSGVhZGVyIC0tPgogICAgPGhlYWRlciBjbGFzcz0iZ2xhc3MtaGVhZGVyIHNoYWRvdy1sZyBwLTQgc3RpY2t5IHRvcC0wIHotMTAiPgogICAgICAgIDxkaXYgY2xhc3M9ImNvbnRhaW5lciBteC1hdXRvIGZsZXgganVzdGlmeS1iZXR3ZWVuIGl0ZW1zLWNlbnRlciI+CiAgICAgICAgICAgIDxoMSBjbGFzcz0idGV4dC0zeGwgZm9udC1ib2xkIGdyYWRpZW50LXRleHQiPkxvcyBBbmdlbGVzIFdlYXRoZXI8L2gxPgogICAgICAgICAgICA8ZGl2IGlkPSJsYXN0LXVwZGF0ZWQiIGNsYXNzPSJ0ZXh0LXNtIHRleHQtZ3JheS00MDAgYmctZ3JheS04MDAgcHgtMyBweS0xIHJvdW5kZWQtZnVsbCI+TGFzdCB1cGRhdGVkOiBGZXRjaGluZyBkYXRhLi4uPC9kaXY+CiAgICAgICAgPC9kaXY+CiAgICA8L2hlYWRlcj4KCiAgICA8IS0tIE1haW4gQ29udGVudCAtLT4KICAgIDxtYWluIGNsYXNzPSJmbGV4LWdyb3cgY29udGFpbmVyIG14LWF1dG8gcC00Ij4KICAgICAgICA8ZGl2IGlkPSJsb2FkaW5nIiBjbGFzcz0iZmxleCBmbGV4LWNvbCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgcHktMjAiPgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJsb2FkaW5nIG1iLTQiPjwvZGl2PgogICAgICAgICAgICA8cCBjbGFzcz0idGV4dC1ncmF5LTQwMCI+RmV0Y2hpbmcgd2VhdGhlciBkYXRhLi4uPC9wPgogICAgICAgIDwvZGl2PgoKICAgICAgICA8ZGl2IGlkPSJ3ZWF0aGVyLWNvbnRlbnQiIGNsYXNzPSJoaWRkZW4gdy1mdWxsIj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0iZmxleCBmbGV4LWNvbCBtZDpmbGV4LXJvdyBtZDpzcGFjZS14LTQgZ2FwLTQiPgogICAgICAgICAgICAgICAgPCEtLSBDdXJyZW50IFdlYXRoZXIgQ2FyZCAtLT4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9IndlYXRoZXItY2FyZCBwLTQgbWQ6cC02IHNoYWRvdy14bCB3LWZ1bGwgbWQ6dy0yLzUiPgogICAgICAgICAgICAgICAgICAgIDxoMiBjbGFzcz0idGV4dC0yeGwgZm9udC1ib2xkIG1iLTQgZ3JhZGllbnQtdGV4dCI+Q3VycmVudCBXZWF0aGVyPC9oMj4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJmbGV4IGl0ZW1zLWNlbnRlciBtYi00Ij4KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBpZD0id2VhdGhlci1pY29uIiBjbGFzcz0idGV4dC02eGwgbXItNCI+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cCBpZD0idGVtcGVyYXR1cmUiIGNsYXNzPSJ0ZXh0LTV4bCBmb250LWJvbGQiPjwvcD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwIGlkPSJ3ZWF0aGVyLWRlc2NyaXB0aW9uIiBjbGFzcz0idGV4dC1ncmF5LTMwMCBjYXBpdGFsaXplIHRleHQtbGcgdHJ1bmNhdGUgbWF4LXctWzE2MHB4XSI+PC9wPgogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJncmlkIGdyaWQtY29scy0yIGdhcC00IG10LTYiPgogICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJmbGV4IGl0ZW1zLWNlbnRlciI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJiZy1ncmF5LTgwMCBwLTIgcm91bmRlZC1sZyBtci0zIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3ZnIGNsYXNzPSJ3LTYgaC02IHRleHQtZ3JheS0zMDAiIGZpbGw9Im5vbmUiIHN0cm9rZT0iY3VycmVudENvbG9yIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxwYXRoIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBkPSJNNSAxM2w0IDRMMTkgNyI+PC9wYXRoPjwvc3ZnPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzPSJ0ZXh0LWdyYXktNDAwIHRleHQtc20iPkZlZWxzIExpa2U8L3A+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHAgaWQ9ImZlZWxzLWxpa2UiIGNsYXNzPSJmb250LW1lZGl1bSB0ZXh0LWJhc2UgdHJ1bmNhdGUiPjwvcD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZmxleCBpdGVtcy1jZW50ZXIiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iYmctZ3JheS04MDAgcC0yIHJvdW5kZWQtbGcgbXItMyI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN2ZyBjbGFzcz0idy02IGgtNiB0ZXh0LWdyYXktMzAwIiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMiIgZD0iTTMgMTVhNCA0IDAgMDA0IDRoOWE1IDUgMCAxMC0uMS05Ljk5OSA1LjAwMiA1LjAwMiAwIDEwLTkuNzggMi4wOTZBNC4wMDEgNC4wMDEgMCAwMDMgMTV6Ij48L3BhdGg+PC9zdmc+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3M9InRleHQtZ3JheS00MDAgdGV4dC1zbSI+SHVtaWRpdHk8L3A+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHAgaWQ9Imh1bWlkaXR5IiBjbGFzcz0iZm9udC1tZWRpdW0gdGV4dC1iYXNlIHRydW5jYXRlIj48L3A+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImZsZXggaXRlbXMtY2VudGVyIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImJnLWdyYXktODAwIHAtMiByb3VuZGVkLWxnIG1yLTMiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzdmcgY2xhc3M9InctNiBoLTYgdGV4dC1ncmF5LTMwMCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJjdXJyZW50Q29sb3IiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Ik0xNy42NTcgMTYuNjU3TDEzLjQxNCAyMC45YTEuOTk4IDEuOTk4IDAgMDEtMi44MjcgMGwtNC4yNDQtNC4yNDNhOCA4IDAgMTExMS4zMTQgMHoiPjwvcGF0aD48cGF0aCBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMiIgZD0iTTE1IDExYTMgMyAwIDExLTYgMCAzIDMgMCAwMTYgMHoiPjwvcGF0aD48L3N2Zz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzcz0idGV4dC1ncmF5LTQwMCB0ZXh0LXNtIj5QcmVzc3VyZTwvcD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cCBpZD0icHJlc3N1cmUiIGNsYXNzPSJmb250LW1lZGl1bSB0ZXh0LWJhc2UgdHJ1bmNhdGUiPjwvcD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZmxleCBpdGVtcy1jZW50ZXIiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iYmctZ3JheS04MDAgcC0yIHJvdW5kZWQtbGcgbXItMyI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHN2ZyBjbGFzcz0idy02IGgtNiB0ZXh0LWdyYXktMzAwIiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMiIgZD0iTTggN2gxMm0wIDBsLTQtNG00IDRsLTQgNG0wIDZING0wIDBsNCA0bS00LTRsNC00Ij48L3BhdGg+PC9zdmc+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3M9InRleHQtZ3JheS00MDAgdGV4dC1zbSI+V2luZDwvcD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8cCBpZD0id2luZCIgY2xhc3M9ImZvbnQtbWVkaXVtIHRleHQtYmFzZSB0cnVuY2F0ZSI+PC9wPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICA8IS0tIERhaWx5IEZvcmVjYXN0IC0tPgogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0id2VhdGhlci1jYXJkIHAtNCBtZDpwLTYgc2hhZG93LXhsIHctZnVsbCBtZDp3LTMvNSI+CiAgICAgICAgICAgICAgICAgICAgPGgyIGNsYXNzPSJ0ZXh0LTJ4bCBmb250LWJvbGQgbWItNCBncmFkaWVudC10ZXh0Ij5EYWlseSBGb3JlY2FzdDwvaDI+CiAgICAgICAgICAgICAgICAgICAgPGRpdiBpZD0iZGFpbHktZm9yZWNhc3QiIGNsYXNzPSJncmlkIGdyaWQtY29scy0xIHNtOmdyaWQtY29scy0yIG1kOmdyaWQtY29scy0zIGxnOmdyaWQtY29scy01IGdhcC0zIj48L2Rpdj4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L2Rpdj4KCiAgICAgICAgPGRpdiBpZD0iZXJyb3ItbWVzc2FnZSIgY2xhc3M9ImhpZGRlbiB0ZXh0LWNlbnRlciBweS0xMCI+CiAgICAgICAgICAgIDxzdmcgY2xhc3M9InctMTYgaC0xNiB0ZXh0LXJlZC01MDAgbXgtYXV0byBtYi00IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMiIgZD0iTTEyIDh2NG0wIDRoLjAxTTIxIDEyYTkgOSAwIDExLTE4IDAgOSA5IDAgMDExOCAweiI+PC9wYXRoPjwvc3ZnPgogICAgICAgICAgICA8aDIgY2xhc3M9InRleHQteGwgZm9udC1ib2xkIHRleHQtcmVkLTQwMCBtYi0yIj5FcnJvciBMb2FkaW5nIFdlYXRoZXIgRGF0YTwvaDI+CiAgICAgICAgICAgIDxwIGNsYXNzPSJ0ZXh0LWdyYXktNDAwIG1iLTQiPlRoZXJlIHdhcyBhIHByb2JsZW0gcmV0cmlldmluZyB0aGUgd2VhdGhlciBpbmZvcm1hdGlvbi48L3A+CiAgICAgICAgICAgIDxidXR0b24gaWQ9InJldHJ5LWJ1dHRvbiIgY2xhc3M9ImJnLWdyYXktNzAwIGhvdmVyOmJnLWdyYXktNjAwIHRleHQtd2hpdGUgZm9udC1ib2xkIHB5LTIgcHgtNiByb3VuZGVkLWxnIHRyYW5zaXRpb24gZHVyYXRpb24tMjAwIHRyYW5zZm9ybSBob3ZlcjpzY2FsZS0xMDUiPgogICAgICAgICAgICAgICAgVHJ5IEFnYWluCiAgICAgICAgICAgIDwvYnV0dG9uPgogICAgICAgIDwvZGl2PgogICAgPC9tYWluPgoKICAgIDwhLS0gRm9vdGVyIC0tPgogICAgPGZvb3RlciBjbGFzcz0iZ2xhc3MtaGVhZGVyIHB5LTMgcHgtNCB0ZXh0LWNlbnRlciB0ZXh0LWdyYXktNDAwIHRleHQtc20iPgogICAgICAgIDxwPlBvd2VyZWQgYnkgT3Blbi1NZXRlbyBBUEkg4oCiIERhdGEgcmVmcmVzaGVzIGV2ZXJ5IDEwIG1pbnV0ZXM8L3A+CiAgICA8L2Zvb3Rlcj4KPC9kaXY+Cgo8c2NyaXB0PgogICAgLy8gQ29uc3RhbnRzCiAgICBjb25zdCBMQVRJVFVERSA9IDM0LjA1NDk7CiAgICBjb25zdCBMT05HSVRVREUgPSAtMTE4LjI0NDU7CiAgICBjb25zdCBSRUZSRVNIX0lOVEVSVkFMID0gMTAgKiA2MCAqIDEwMDA7CgogICAgY29uc3Qgd2VhdGhlckljb25zID0gewogICAgICAgICdjbGVhcic6ICfimIDvuI8nLAogICAgICAgICdzdW5ueSc6ICfimIDvuI8nLAogICAgICAgICdwYXJ0bHkgY2xvdWR5JzogJ+KbhScsCiAgICAgICAgJ2Nsb3VkeSc6ICfimIHvuI8nLAogICAgICAgICdvdmVyY2FzdCc6ICfimIHvuI8nLAogICAgICAgICdyYWluJzogJ/CfjKfvuI8nLAogICAgICAgICdzaG93ZXJzJzogJ/CfjKbvuI8nLAogICAgICAgICd0aHVuZGVyc3Rvcm0nOiAn4puI77iPJywKICAgICAgICAnc25vdyc6ICfinYTvuI8nLAogICAgICAgICdtaXN0JzogJ/CfjKvvuI8nLAogICAgICAgICdmb2cnOiAn8J+Mq++4jycsCiAgICAgICAgJ2RlZmF1bHQnOiAn8J+Moe+4jycKICAgIH07CgogICAgY29uc3QgbG9hZGluZ0VsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmcnKTsKICAgIGNvbnN0IHdlYXRoZXJDb250ZW50RWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd2VhdGhlci1jb250ZW50Jyk7CiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlcnJvci1tZXNzYWdlJyk7CiAgICBjb25zdCByZXRyeUJ1dHRvbkVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JldHJ5LWJ1dHRvbicpOwogICAgY29uc3QgbGFzdFVwZGF0ZWRFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsYXN0LXVwZGF0ZWQnKTsKCiAgICBhc3luYyBmdW5jdGlvbiBmZXRjaFdlYXRoZXJEYXRhKCkgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHNob3dMb2FkaW5nKCk7CgogICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGBodHRwczovL2FwaS5vcGVuLW1ldGVvLmNvbS92MS9mb3JlY2FzdD9sYXRpdHVkZT0ke0xBVElUVURFfSZsb25naXR1ZGU9JHtMT05HSVRVREV9JmN1cnJlbnQ9dGVtcGVyYXR1cmVfMm0scmVsYXRpdmVfaHVtaWRpdHlfMm0sd2luZF9zcGVlZF8xMG0sd2VhdGhlcl9jb2RlLHByZXNzdXJlX21zbCZob3VybHk9dGVtcGVyYXR1cmVfMm0sd2VhdGhlcl9jb2RlJmRhaWx5PXdlYXRoZXJfY29kZSx0ZW1wZXJhdHVyZV8ybV9tYXgsdGVtcGVyYXR1cmVfMm1fbWluJnRpbWV6b25lPWF1dG9gKTsKCiAgICAgICAgICAgIGlmICghcmVzcG9uc2Uub2spIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGZldGNoIHdlYXRoZXIgZGF0YScpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpOwogICAgICAgICAgICB1cGRhdGVVSShkYXRhKTsKCiAgICAgICAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7CiAgICAgICAgICAgIGxhc3RVcGRhdGVkRWwudGV4dENvbnRlbnQgPSBgTGFzdCB1cGRhdGVkOiAke25vdy50b0xvY2FsZVRpbWVTdHJpbmcoKX1gOwoKICAgICAgICAgICAgc2hvd1dlYXRoZXJDb250ZW50KCk7CiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgd2VhdGhlciBkYXRhOicsIGVycm9yKTsKICAgICAgICAgICAgc2hvd0Vycm9yKCk7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIGdldFdlYXRoZXJEZXNjcmlwdGlvbihjb2RlKSB7CiAgICAgICAgY29uc3Qgd2VhdGhlckNvZGVzID0gewogICAgICAgICAgICAwOiAnY2xlYXIgc2t5JywKICAgICAgICAgICAgMTogJ21haW5seSBjbGVhcicsCiAgICAgICAgICAgIDI6ICdwYXJ0bHkgY2xvdWR5JywKICAgICAgICAgICAgMzogJ292ZXJjYXN0JywKICAgICAgICAgICAgNDU6ICdmb2cnLAogICAgICAgICAgICA0ODogJ2RlcG9zaXRpbmcgcmltZSBmb2cnLAogICAgICAgICAgICA1MTogJ2xpZ2h0IGRyaXp6bGUnLAogICAgICAgICAgICA1MzogJ21vZGVyYXRlIGRyaXp6bGUnLAogICAgICAgICAgICA1NTogJ2RlbnNlIGRyaXp6bGUnLAogICAgICAgICAgICA1NjogJ2xpZ2h0IGZyZWV6aW5nIGRyaXp6bGUnLAogICAgICAgICAgICA1NzogJ2RlbnNlIGZyZWV6aW5nIGRyaXp6bGUnLAogICAgICAgICAgICA2MTogJ3NsaWdodCByYWluJywKICAgICAgICAgICAgNjM6ICdtb2RlcmF0ZSByYWluJywKICAgICAgICAgICAgNjU6ICdoZWF2eSByYWluJywKICAgICAgICAgICAgNjY6ICdsaWdodCBmcmVlemluZyByYWluJywKICAgICAgICAgICAgNjc6ICdoZWF2eSBmcmVlemluZyByYWluJywKICAgICAgICAgICAgNzE6ICdzbGlnaHQgc25vdyBmYWxsJywKICAgICAgICAgICAgNzM6ICdtb2RlcmF0ZSBzbm93IGZhbGwnLAogICAgICAgICAgICA3NTogJ2hlYXZ5IHNub3cgZmFsbCcsCiAgICAgICAgICAgIDc3OiAnc25vdyBncmFpbnMnLAogICAgICAgICAgICA4MDogJ3NsaWdodCByYWluIHNob3dlcnMnLAogICAgICAgICAgICA4MTogJ21vZGVyYXRlIHJhaW4gc2hvd2VycycsCiAgICAgICAgICAgIDgyOiAndmlvbGVudCByYWluIHNob3dlcnMnLAogICAgICAgICAgICA4NTogJ3NsaWdodCBzbm93IHNob3dlcnMnLAogICAgICAgICAgICA4NjogJ2hlYXZ5IHNub3cgc2hvd2VycycsCiAgICAgICAgICAgIDk1OiAndGh1bmRlcnN0b3JtJywKICAgICAgICAgICAgOTY6ICd0aHVuZGVyc3Rvcm0gd2l0aCBzbGlnaHQgaGFpbCcsCiAgICAgICAgICAgIDk5OiAndGh1bmRlcnN0b3JtIHdpdGggaGVhdnkgaGFpbCcKICAgICAgICB9OwoKICAgICAgICByZXR1cm4gd2VhdGhlckNvZGVzW2NvZGVdIHx8ICd1bmtub3duJzsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRXZWF0aGVySWNvbihkZXNjcmlwdGlvbikgewogICAgICAgIGZvciAoY29uc3QgW2tleSwgaWNvbl0gb2YgT2JqZWN0LmVudHJpZXMod2VhdGhlckljb25zKSkgewogICAgICAgICAgICBpZiAoZGVzY3JpcHRpb24uaW5jbHVkZXMoa2V5KSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGljb247CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHdlYXRoZXJJY29ucy5kZWZhdWx0OwogICAgfQoKICAgIGZ1bmN0aW9uIHVwZGF0ZVVJKGRhdGEpIHsKICAgICAgICBjb25zdCBjdXJyZW50VGVtcCA9IGRhdGEuY3VycmVudC50ZW1wZXJhdHVyZV8ybTsKICAgICAgICBjb25zdCB3ZWF0aGVyRGVzYyA9IGdldFdlYXRoZXJEZXNjcmlwdGlvbihkYXRhLmN1cnJlbnQud2VhdGhlcl9jb2RlKTsKICAgICAgICBjb25zdCB3ZWF0aGVySWNvbiA9IGdldFdlYXRoZXJJY29uKHdlYXRoZXJEZXNjKTsKCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RlbXBlcmF0dXJlJykudGV4dENvbnRlbnQgPSBgJHtjdXJyZW50VGVtcH3CsENgOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3ZWF0aGVyLWRlc2NyaXB0aW9uJykudGV4dENvbnRlbnQgPSB3ZWF0aGVyRGVzYzsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd2VhdGhlci1pY29uJykudGV4dENvbnRlbnQgPSB3ZWF0aGVySWNvbjsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaHVtaWRpdHknKS50ZXh0Q29udGVudCA9IGAke2RhdGEuY3VycmVudC5yZWxhdGl2ZV9odW1pZGl0eV8ybX0lYDsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd2luZCcpLnRleHRDb250ZW50ID0gYCR7ZGF0YS5jdXJyZW50LndpbmRfc3BlZWRfMTBtfSBtL3NgOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcmVzc3VyZScpLnRleHRDb250ZW50ID0gYCR7ZGF0YS5jdXJyZW50LnByZXNzdXJlX21zbH0gaFBhYDsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmVlbHMtbGlrZScpLnRleHRDb250ZW50ID0gYCR7Y3VycmVudFRlbXB9wrBDYDsKCiAgICAgICAgdXBkYXRlRGFpbHlGb3JlY2FzdChkYXRhLmRhaWx5KTsKICAgIH0KCiAgICBmdW5jdGlvbiB1cGRhdGVEYWlseUZvcmVjYXN0KGRhaWx5RGF0YSkgewogICAgICAgIGNvbnN0IGRhaWx5Rm9yZWNhc3RFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkYWlseS1mb3JlY2FzdCcpOwogICAgICAgIGRhaWx5Rm9yZWNhc3RFbC5pbm5lckhUTUwgPSAnJzsKCiAgICAgICAgY29uc3QgZGF5cyA9IFsnU3VuJywgJ01vbicsICdUdWUnLCAnV2VkJywgJ1RodScsICdGcmknLCAnU2F0J107CgogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGFpbHlEYXRhLnRpbWUubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKGRhaWx5RGF0YS50aW1lW2ldKTsKICAgICAgICAgICAgY29uc3QgZGF5TmFtZSA9IGRheXNbZGF0ZS5nZXREYXkoKV07CiAgICAgICAgICAgIGNvbnN0IHdlYXRoZXJEZXNjID0gZ2V0V2VhdGhlckRlc2NyaXB0aW9uKGRhaWx5RGF0YS53ZWF0aGVyX2NvZGVbaV0pOwogICAgICAgICAgICBjb25zdCB3ZWF0aGVySWNvbiA9IGdldFdlYXRoZXJJY29uKHdlYXRoZXJEZXNjKTsKICAgICAgICAgICAgY29uc3QgbWF4VGVtcCA9IGRhaWx5RGF0YS50ZW1wZXJhdHVyZV8ybV9tYXhbaV07CiAgICAgICAgICAgIGNvbnN0IG1pblRlbXAgPSBkYWlseURhdGEudGVtcGVyYXR1cmVfMm1fbWluW2ldOwoKICAgICAgICAgICAgY29uc3QgZGF5RWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICAgICAgZGF5RWwuY2xhc3NOYW1lID0gJ3dlYXRoZXItY2FyZCBwLTMgdGV4dC1jZW50ZXIgdHJhbnNpdGlvbi1hbGwgZHVyYXRpb24tMzAwJzsKICAgICAgICAgICAgZGF5RWwuaW5uZXJIVE1MID0gYAogICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzPSJmb250LWJvbGQgdGV4dC1iYXNlIHRydW5jYXRlIj4ke2RheU5hbWV9PC9wPgogICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzPSJ0ZXh0LXhzIHRleHQtZ3JheS00MDAiPiR7ZGF0ZS5nZXREYXRlKCl9LyR7ZGF0ZS5nZXRNb250aCgpICsgMX08L3A+CiAgICAgICAgICAgICAgICAgICAgPHAgY2xhc3M9InRleHQtM3hsIG15LTIiPiR7d2VhdGhlckljb259PC9wPgogICAgICAgICAgICAgICAgICAgIDxwIGNsYXNzPSJ0ZXh0LXhzIGNhcGl0YWxpemUgdGV4dC1ncmF5LTMwMCB0cnVuY2F0ZSBtYXgtdy1bMTIwcHhdIG14LWF1dG8iPiR7d2VhdGhlckRlc2N9PC9wPgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImZsZXgganVzdGlmeS1iZXR3ZWVuIG10LTIgcHgtMSI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJ0ZXh0LWdyYXktMzAwIGZvbnQtYm9sZCB0ZXh0LWJhc2UiPiR7bWF4VGVtcH3CsDwvc3Bhbj4KICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9InRleHQtZ3JheS00MDAgZm9udC1ib2xkIHRleHQtYmFzZSI+JHttaW5UZW1wfcKwPC9zcGFuPgogICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgYDsKCiAgICAgICAgICAgIGRhaWx5Rm9yZWNhc3RFbC5hcHBlbmRDaGlsZChkYXlFbCk7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIHNob3dMb2FkaW5nKCkgewogICAgICAgIGxvYWRpbmdFbC5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTsKICAgICAgICB3ZWF0aGVyQ29udGVudEVsLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpOwogICAgICAgIGVycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpOwogICAgfQoKICAgIGZ1bmN0aW9uIHNob3dXZWF0aGVyQ29udGVudCgpIHsKICAgICAgICBsb2FkaW5nRWwuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7CiAgICAgICAgd2VhdGhlckNvbnRlbnRFbC5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTsKICAgICAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTsKICAgIH0KCiAgICBmdW5jdGlvbiBzaG93RXJyb3IoKSB7CiAgICAgICAgbG9hZGluZ0VsLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpOwogICAgICAgIHdlYXRoZXJDb250ZW50RWwuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7CiAgICAgICAgZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7CiAgICB9CgogICAgcmV0cnlCdXR0b25FbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZldGNoV2VhdGhlckRhdGEpOwoKICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoKSA9PiB7CiAgICAgICAgZmV0Y2hXZWF0aGVyRGF0YSgpOwogICAgICAgIHNldEludGVydmFsKGZldGNoV2VhdGhlckRhdGEsIFJFRlJFU0hfSU5URVJWQUwpOwogICAgfSk7Cjwvc2NyaXB0Pgo8L2JvZHk+CjwvaHRtbD4K";